<!DOCTYPE html>
<html dir="ltr" lang="en-US">

<head>

    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta http-equiv="x-ua-compatible" content="IE=edge">
    <meta name="author" content="SemiColonWeb">
    <meta name="description"
        content="Get Canvas to build powerful websites easily with the Highly Customizable &amp; Best Selling Bootstrap Template, today.">

    <!-- Font Imports -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:ital@0;1&display=swap"
        rel="stylesheet">

    <!-- Core Style -->
    <link rel="stylesheet" href="style.css">

    <!-- Font Icons -->
    <link rel="stylesheet" href="css/font-icons.css">

    <!-- Plugins/Components CSS -->
    <link rel="stylesheet" href="css/swiper.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/custom.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Document Title
	============================================= -->
    <title>Header - eCommerce Minimal | Canvas</title>

    <style>
        @media (min-width: 992px) {
            .header-misc-icon>a {
                width: 1.5rem;
                height: 1.5rem;
                font-size: 1.5rem;
                line-height: 1.5rem;
            }
        }

        .header-row .fbox-sm .fbox-icon {
            width: 1.25rem;
            height: 1.25rem;
        }

        .header-row .fbox-sm .fbox-icon i {
            position: relative;
            top: 1px;
            font-size: 1.25rem;
        }

        .header-shop-search input::-moz-placeholder {
            font-style: italic;
            opacity: .7;
        }

        .header-shop-search input::-webkit-input-placeholder {
            font-style: italic;
            opacity: .7;
        }
    </style>

</head>

<body class="stretched">

    <div id="wrapper">



        <main id="content">
            <div class="content-wrap">
                <div class="container">
                    <div class="wrap">
                        <div class="top">
                            <div class="title">Create Event (Vanilla JS Wizard)</div>
                            <div class="progress" id="progressDots" aria-label="Progress"></div>
                        </div>

                        <div class="card">
                            <form id="eventForm" novalidate>
                                <!-- STEP 1 -->
                                <section class="step active" data-step="1">
                                    <div class="sectionTitle">1) Event Name</div>
                                    <div class="grid">
                                        <div>
                                            <label for="eventName">Event name</label>
                                            <input id="eventName" name="eventName"
                                                placeholder="e.g., Flutter Meetup Kathmandu" />
                                            <div class="hint">This will be used as the main title of your event.</div>
                                        </div>
                                    </div>

                                    <div class="error" id="errorStep1"></div>

                                    <div class="actions">
                                        <button class="btn secondary" type="button" id="back1" disabled>Back</button>
                                        <button class="btn" type="button" id="next1">Continue</button>
                                    </div>
                                </section>

                                <!-- STEP 2 -->
                                <section class="step" data-step="2">
                                    <div class="sectionTitle">2) Event Details</div>

                                    <!-- 2.1 -->
                                    <div class="sectionTitle">2.1) Tickets</div>
                                    <div class="row" role="radiogroup" aria-label="Ticketing">
                                        <label class="pill">
                                            <input type="radio" name="ticketing" value="free" checked />
                                            No, my event is free to attend
                                        </label>
                                        <label class="pill">
                                            <input type="radio" name="ticketing" value="paid" />
                                            Yes, I am selling tickets
                                        </label>
                                    </div>
                                    <div id="paidHint" class="hint" style="display:none;">
                                        You selected paid tickets (you can add pricing later).
                                    </div>

                                    <!-- 2.2 -->
                                    <div class="sectionTitle">2.2) Event type</div>
                                    <div class="row" role="radiogroup" aria-label="Event type">
                                        <label class="pill">
                                            <input type="radio" name="eventType" value="single" checked />
                                            Single date, time and location
                                        </label>
                                        <label class="pill">
                                            <input type="radio" name="eventType" value="multiple" />
                                            Multiple dates/time & sessions
                                        </label>
                                        <label class="pill">
                                            <input type="radio" name="eventType" value="appointment" />
                                            Appointment scheduling
                                        </label>
                                    </div>

                                    <!-- 2.3 -->
                                    <div class="sectionTitle">2.3) When is your event?</div>

                                    <div id="singleBlock" class="miniCard">
                                        <div class="grid">
                                            <div>
                                                <label for="startDate">Event start date</label>
                                                <input id="startDate" type="date" />
                                            </div>
                                            <div>
                                                <label for="startTime">Event start time</label>
                                                <input id="startTime" type="time" />
                                            </div>

                                            <div>
                                                <label for="endDate">Event end date</label>
                                                <input id="endDate" type="date" />
                                            </div>
                                            <div>
                                                <label for="endTime">Event end time</label>
                                                <input id="endTime" type="time" />
                                            </div>

                                            <div>
                                                <label for="timezone">Timezone</label>
                                                <select id="timezone"></select>
                                            </div>

                                            <div>
                                                <label for="location">Location</label>
                                                <input id="location" placeholder="e.g., Thamel, Kathmandu / Online" />
                                            </div>
                                        </div>
                                    </div>

                                    <div id="multipleBlock" class="miniCard" style="display:none;">
                                        <div class="sessionHeader">
                                            <div>
                                                <div style="font-weight:700;">Sessions</div>
                                                <div class="hint">Add one or more sessions (each with
                                                    date/time/location).</div>
                                            </div>
                                            <button class="xbtn" type="button" id="addSessionBtn">+ Add session</button>
                                        </div>

                                        <div class="grid">
                                            <div>
                                                <label for="timezoneMultiple">Timezone</label>
                                                <select id="timezoneMultiple"></select>
                                            </div>
                                        </div>

                                        <div id="sessionsWrap"
                                            style="margin-top:12px; display:flex; flex-direction:column; gap:12px;">
                                        </div>
                                    </div>

                                    <div id="appointmentBlock" class="miniCard" style="display:none;">
                                        <div class="grid">
                                            <div>
                                                <label for="apptStartDate">Availability start date</label>
                                                <input id="apptStartDate" type="date" />
                                            </div>
                                            <div>
                                                <label for="apptEndDate">Availability end date</label>
                                                <input id="apptEndDate" type="date" />
                                            </div>
                                            <div>
                                                <label for="apptDuration">Appointment duration (minutes)</label>
                                                <input id="apptDuration" type="number" min="5" step="5"
                                                    placeholder="e.g., 30" />
                                            </div>
                                            <div>
                                                <label for="timezoneAppointment">Timezone</label>
                                                <select id="timezoneAppointment"></select>
                                            </div>
                                        </div>
                                        <div class="hint">This is a simple placeholder setup. You can expand to time
                                            slots later.</div>
                                    </div>

                                    <!-- 2.4 -->
                                    <div class="sectionTitle">2.4) Event URL</div>
                                    <div class="grid">
                                        <div>
                                            <label for="eventUrl">Event URL</label>
                                            <input id="eventUrl" type="url"
                                                placeholder="https://example.com/my-event" />
                                        </div>
                                    </div>

                                    <div class="error" id="errorStep2"></div>

                                    <div class="actions">
                                        <button class="btn secondary" type="button" id="back2">Back</button>
                                        <button class="btn" type="button" id="next2">Continue</button>
                                    </div>
                                </section>

                                <!-- STEP 3 -->
                                <section class="step" data-step="3">
                                    <div class="sectionTitle">3) Event Theme</div>
                                    <div class="grid">
                                        <div>
                                            <label for="theme">Choose a theme (sample)</label>
                                            <select id="theme">
                                                <option value="">Select theme</option>
                                                <option value="minimal">Minimal</option>
                                                <option value="vibrant">Vibrant</option>
                                            </select>
                                            <div class="hint">Only 2 sample options for now.</div>
                                        </div>
                                    </div>

                                    <div class="error" id="errorStep3"></div>

                                    <div class="actions">
                                        <button class="btn secondary" type="button" id="back3">Back</button>
                                        <button class="btn" type="button" id="finish">Finish</button>
                                    </div>
                                </section>

                                <!-- FINISH -->
                                <section class="step" data-step="4">
                                    <div class="sectionTitle">Finish ✅</div>
                                    <div class="hint">Here’s your collected data (you can send this to your backend).
                                    </div>
                                    <pre id="result"></pre>

                                    <div class="actions">
                                        <button class="btn secondary" type="button" id="edit">Edit</button>
                                        <button class="btn" type="button" id="reset">Create another</button>
                                    </div>
                                </section>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </main><!-- #content end -->




    </div><!-- #wrapper end -->

    <!-- Go To Top
	============================================= -->
    <div id="gotoTop" class="uil uil-angle-up"></div>

    <!-- JavaScripts
	============================================= -->
    <script src="js/plugins.min.js"></script>
    <script src="js/functions.bundle.js"></script>
    <script>
        // ---------- Wizard State ----------
        const state = {
            eventName: "",
            ticketing: "free", // free | paid
            eventType: "single", // single | multiple | appointment
            single: {
                startDate: "",
                startTime: "",
                endDate: "",
                endTime: "",
                timezone: "",
                location: "",
            },
            multiple: {
                timezone: "",
                sessions: [], // [{date, startTime, endTime, location}]
            },
            appointment: {
                availabilityStartDate: "",
                availabilityEndDate: "",
                durationMinutes: "",
                timezone: "",
            },
            eventUrl: "",
            theme: "",
        };

        // ---------- Helpers ----------
        const $ = (sel) => document.querySelector(sel);
        const $$ = (sel) => document.querySelectorAll(sel);

        function showError(el, msg) {
            el.textContent = msg || "";
            el.classList.toggle("show", !!msg);
        }

        function showStep(stepNum) {
            $$(".step").forEach((s) => s.classList.remove("active"));
            document.querySelector(`.step[data-step="${stepNum}"]`).classList.add("active");
            updateDots(stepNum);
            window.scrollTo({ top: 0, behavior: "smooth" });
        }

        function buildDots() {
            const dotsWrap = $("#progressDots");
            dotsWrap.innerHTML = "";
            // steps: 1,2,3,4
            for (let i = 1; i <= 4; i++) {
                const d = document.createElement("div");
                d.className = "dot";
                d.title = `Step ${i}`;
                dotsWrap.appendChild(d);
            }
            updateDots(1);
        }

        function updateDots(activeStep) {
            const dots = [...$("#progressDots").children];
            dots.forEach((dot, idx) => {
                const step = idx + 1;
                dot.classList.remove("active", "done");
                if (step < activeStep) dot.classList.add("done");
                if (step === activeStep) dot.classList.add("active");
            });
        }

        function isValidUrl(url) {
            if (!url) return true; // optional
            try {
                new URL(url);
                return true;
            } catch {
                return false;
            }
        }

        // Timezone list (best effort)
        function getTimezones() {
            // Modern browsers:
            if (typeof Intl !== "undefined" && Intl.supportedValuesOf) {
                try {
                    return Intl.supportedValuesOf("timeZone");
                } catch { }
            }
            // fallback
            return [
                "Asia/Kathmandu",
                "Asia/Kolkata",
                "UTC",
                "Europe/London",
                "America/New_York",
                "America/Los_Angeles",
                "Asia/Tokyo",
                "Australia/Sydney",
            ];
        }

        function fillTimezoneSelect(selectEl, preferred = "Asia/Kathmandu") {
            const tzs = getTimezones();
            selectEl.innerHTML = "";
            tzs.forEach((tz) => {
                const opt = document.createElement("option");
                opt.value = tz;
                opt.textContent = tz;
                selectEl.appendChild(opt);
            });

            // best default: browser tz if present, else preferred
            const browserTz = Intl.DateTimeFormat().resolvedOptions().timeZone;
            const defaultTz = tzs.includes(browserTz) ? browserTz : (tzs.includes(preferred) ? preferred : tzs[0]);
            selectEl.value = defaultTz;
        }

        // ---------- Step 2 conditional UI ----------
        function updateTicketingUI() {
            const val = document.querySelector('input[name="ticketing"]:checked')?.value || "free";
            state.ticketing = val;
            $("#paidHint").style.display = val === "paid" ? "block" : "none";
        }

        function updateEventTypeUI() {
            const type = document.querySelector('input[name="eventType"]:checked')?.value || "single";
            state.eventType = type;

            $("#singleBlock").style.display = type === "single" ? "block" : "none";
            $("#multipleBlock").style.display = type === "multiple" ? "block" : "none";
            $("#appointmentBlock").style.display = type === "appointment" ? "block" : "none";
        }

        // ---------- Multiple sessions ----------
        function addSession(prefill = {}) {
            const idx = state.multiple.sessions.length;
            state.multiple.sessions.push({
                date: prefill.date || "",
                startTime: prefill.startTime || "",
                endTime: prefill.endTime || "",
                location: prefill.location || "",
            });

            const card = document.createElement("div");
            card.className = "miniCard";
            card.dataset.sessionIndex = String(idx);

            card.innerHTML = `
          <div class="sessionHeader">
            <div style="font-weight:700;">Session #${idx + 1}</div>
            <button class="xbtn" type="button" data-remove-session="${idx}">Remove</button>
          </div>
          <div class="grid">
            <div>
              <label>Date</label>
              <input type="date" data-s-date="${idx}" value="${state.multiple.sessions[idx].date}">
            </div>
            <div>
              <label>Location</label>
              <input type="text" placeholder="e.g., Hall A / Online" data-s-location="${idx}" value="${state.multiple.sessions[idx].location}">
            </div>
            <div>
              <label>Start time</label>
              <input type="time" data-s-start="${idx}" value="${state.multiple.sessions[idx].startTime}">
            </div>
            <div>
              <label>End time</label>
              <input type="time" data-s-end="${idx}" value="${state.multiple.sessions[idx].endTime}">
            </div>
          </div>
        `;
            $("#sessionsWrap").appendChild(card);
        }

        function rebuildSessionsUI() {
            $("#sessionsWrap").innerHTML = "";
            const old = [...state.multiple.sessions];
            state.multiple.sessions = [];
            old.forEach((s) => addSession(s));
        }

        function removeSession(index) {
            state.multiple.sessions.splice(index, 1);
            rebuildSessionsUI();
        }

        // ---------- Collect inputs ----------
        function collectStep1() {
            state.eventName = $("#eventName").value.trim();
        }

        function collectStep2() {
            updateTicketingUI();
            updateEventTypeUI();

            state.eventUrl = $("#eventUrl").value.trim();

            if (state.eventType === "single") {
                state.single.startDate = $("#startDate").value;
                state.single.startTime = $("#startTime").value;
                state.single.endDate = $("#endDate").value;
                state.single.endTime = $("#endTime").value;
                state.single.timezone = $("#timezone").value;
                state.single.location = $("#location").value.trim();
            } else if (state.eventType === "multiple") {
                state.multiple.timezone = $("#timezoneMultiple").value;

                // pull from dynamic fields
                const sessions = [];
                const count = $("#sessionsWrap").children.length;
                for (let i = 0; i < count; i++) {
                    const date = document.querySelector(`[data-s-date="${i}"]`)?.value || "";
                    const location = document.querySelector(`[data-s-location="${i}"]`)?.value?.trim() || "";
                    const startTime = document.querySelector(`[data-s-start="${i}"]`)?.value || "";
                    const endTime = document.querySelector(`[data-s-end="${i}"]`)?.value || "";
                    sessions.push({ date, startTime, endTime, location });
                }
                state.multiple.sessions = sessions;
            } else if (state.eventType === "appointment") {
                state.appointment.availabilityStartDate = $("#apptStartDate").value;
                state.appointment.availabilityEndDate = $("#apptEndDate").value;
                state.appointment.durationMinutes = $("#apptDuration").value.trim();
                state.appointment.timezone = $("#timezoneAppointment").value;
            }
        }

        function collectStep3() {
            state.theme = $("#theme").value;
        }

        // ---------- Validation ----------
        function validateStep1() {
            const err = $("#errorStep1");
            showError(err, "");

            if (!state.eventName) {
                showError(err, "Please enter an event name.");
                return false;
            }
            return true;
        }

        function validateStep2() {
            const err = $("#errorStep2");
            showError(err, "");

            if (!isValidUrl(state.eventUrl)) {
                showError(err, "Please enter a valid Event URL (or leave it empty).");
                return false;
            }

            if (state.eventType === "single") {
                const { startDate, startTime, endDate, endTime, timezone } = state.single;
                if (!startDate || !startTime || !endDate || !endTime) {
                    showError(err, "Please fill start/end date and time for your event.");
                    return false;
                }
                if (!timezone) {
                    showError(err, "Please select a timezone.");
                    return false;
                }
                // Basic chronological check (best-effort)
                const start = new Date(`${startDate}T${startTime}`);
                const end = new Date(`${endDate}T${endTime}`);
                if (end <= start) {
                    showError(err, "End date/time must be after start date/time.");
                    return false;
                }
            }

            if (state.eventType === "multiple") {
                if (!state.multiple.timezone) {
                    showError(err, "Please select a timezone for sessions.");
                    return false;
                }
                if (!state.multiple.sessions.length) {
                    showError(err, "Please add at least one session.");
                    return false;
                }
                for (let i = 0; i < state.multiple.sessions.length; i++) {
                    const s = state.multiple.sessions[i];
                    if (!s.date || !s.startTime || !s.endTime) {
                        showError(err, `Please complete date/start/end time for Session #${i + 1}.`);
                        return false;
                    }
                    const start = new Date(`${s.date}T${s.startTime}`);
                    const end = new Date(`${s.date}T${s.endTime}`);
                    if (end <= start) {
                        showError(err, `Session #${i + 1}: end time must be after start time.`);
                        return false;
                    }
                }
            }

            if (state.eventType === "appointment") {
                const a = state.appointment;
                if (!a.availabilityStartDate || !a.availabilityEndDate || !a.durationMinutes || !a.timezone) {
                    showError(err, "Please fill availability start/end date, duration, and timezone.");
                    return false;
                }
                const s = new Date(`${a.availabilityStartDate}T00:00`);
                const e = new Date(`${a.availabilityEndDate}T00:00`);
                if (e < s) {
                    showError(err, "Availability end date must be after start date.");
                    return false;
                }
                const dur = Number(a.durationMinutes);
                if (!Number.isFinite(dur) || dur < 5) {
                    showError(err, "Duration must be a number (minimum 5 minutes).");
                    return false;
                }
            }

            return true;
        }

        function validateStep3() {
            const err = $("#errorStep3");
            showError(err, "");
            if (!state.theme) {
                showError(err, "Please select a theme.");
                return false;
            }
            return true;
        }

        // ---------- Finish ----------
        function renderResult() {
            const clean = JSON.parse(JSON.stringify(state));

            // optional: remove unused branches for cleaner output
            if (clean.eventType !== "single") delete clean.single;
            if (clean.eventType !== "multiple") delete clean.multiple;
            if (clean.eventType !== "appointment") delete clean.appointment;

            $("#result").textContent = JSON.stringify(clean, null, 2);
            console.log("Event form result:", clean);
        }

        function resetAll() {
            // reset state
            state.eventName = "";
            state.ticketing = "free";
            state.eventType = "single";
            state.single = { startDate: "", startTime: "", endDate: "", endTime: "", timezone: "", location: "" };
            state.multiple = { timezone: "", sessions: [] };
            state.appointment = { availabilityStartDate: "", availabilityEndDate: "", durationMinutes: "", timezone: "" };
            state.eventUrl = "";
            state.theme = "";

            // reset UI
            $("#eventName").value = "";
            document.querySelector('input[name="ticketing"][value="free"]').checked = true;
            document.querySelector('input[name="eventType"][value="single"]').checked = true;
            $("#eventUrl").value = "";
            $("#theme").value = "";

            $("#startDate").value = "";
            $("#startTime").value = "";
            $("#endDate").value = "";
            $("#endTime").value = "";
            $("#location").value = "";

            $("#apptStartDate").value = "";
            $("#apptEndDate").value = "";
            $("#apptDuration").value = "";

            $("#sessionsWrap").innerHTML = "";
            state.multiple.sessions = [];

            updateTicketingUI();
            updateEventTypeUI();
            showStep(1);
        }

        // ---------- Events ----------
        document.addEventListener("change", (e) => {
            if (e.target.matches('input[name="ticketing"]')) updateTicketingUI();
            if (e.target.matches('input[name="eventType"]')) updateEventTypeUI();

            // dynamic session inputs reflect in state immediately (optional)
            const t = e.target;
            if (t.dataset.sDate || t.dataset.sStart || t.dataset.sEnd || t.dataset.sLocation) {
                // We re-collect sessions on Continue, so this is optional.
            }
        });

        document.addEventListener("click", (e) => {
            const t = e.target;

            if (t.id === "addSessionBtn") {
                addSession();
            }

            if (t.dataset.removeSession !== undefined) {
                const idx = Number(t.dataset.removeSession);
                removeSession(idx);
            }
        });

        $("#next1").addEventListener("click", () => {
            collectStep1();
            if (!validateStep1()) return;
            showStep(2);
        });

        $("#back2").addEventListener("click", () => showStep(1));
        $("#next2").addEventListener("click", () => {
            collectStep2();
            if (!validateStep2()) return;
            showStep(3);
        });

        $("#back3").addEventListener("click", () => showStep(2));
        $("#finish").addEventListener("click", () => {
            collectStep3();
            if (!validateStep3()) return;

            // Ensure latest step 2 values are collected before final output
            collectStep2();
            renderResult();
            showStep(4);
        });

        $("#edit").addEventListener("click", () => showStep(1));
        $("#reset").addEventListener("click", resetAll);

        // prevent actual submit
        $("#eventForm").addEventListener("submit", (e) => e.preventDefault());

        // ---------- Init ----------
        buildDots();
        fillTimezoneSelect($("#timezone"));
        fillTimezoneSelect($("#timezoneMultiple"));
        fillTimezoneSelect($("#timezoneAppointment"));

        // preselect default timezones into state after filling
        state.single.timezone = $("#timezone").value;
        state.multiple.timezone = $("#timezoneMultiple").value;
        state.appointment.timezone = $("#timezoneAppointment").value;

        updateTicketingUI();
        updateEventTypeUI();

        // If "multiple sessions" is chosen later, start with 1 session for convenience
        // (kept off by default, uncomment if you want)
        // addSession();
    </script>
</body>

</html>